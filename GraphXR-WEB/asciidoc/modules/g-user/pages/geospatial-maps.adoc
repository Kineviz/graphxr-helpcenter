= Display Data on a World Map

The *_Map_* panel lets you position nodes on a world map. 

NOTE: The map servers provided by default are Mapbox, Google, and OpenStreetMap. 

When you open the *_Map_* panel, a world map is displayed and nodes in the project space that have latitude and longitude property values are automatically dropped onto the map.

image::/v2_17/09_01_01_MapView.png[,720,480,role=text-left]

Nodes with no latitude and longitude coordinates which are connected to those on the map are also displayed with their connecting edges, positioned above the map. By default, a force-directed layout is used for these nodes, unless a geometric layout has been applied to them.

image::/v2_17/09_01_02_PhotoMap.png[,720,380,role=text-left]

Nodes with geospatial coordinates are pinned to the map until you hide the map, at which time they are released and displayed in the default force-directed layout.

== Format for Latitude and Longitude coordinates

Geospatial data must be encoded in the data in separate latitude(_lat_) and longitude(_lng_) properties as follows:

[cols="1,2,4"]
|===
|  | *Property Name* | *Example Value*

| Latitude
| _lat_
| `-74.006393`

| Longitude
| _lng_
| `40.714172`
|===

The _lat_ and _lng_ values must be floating point, not strings. Most lat-long data are encoded that way, but if not, strings can be transformed using _toNumber_ or a custom transform in the *_f(x)_* transform panel.

The .KML and .KMZ (https://en.wikipedia.org/wiki/Keyhole_Markup_Language[Keyhole Markup Language/Keyhole Markup Zip]) files used by mapping applications such as Google Earth contain appropriately encoded coordinates, and you can map these files directly in GraphXR.

image::/v2_17/09_01_03_LatLongKMZ.png[,720,380,role=text-left]

== Navigating and working with mapped data

When you click *_Map_* in the *_Main Menu_*, the *_Map_* panel opens, automatically displaying nodes pinned to their geospatial locations on a 2D map surface rendered in the 3D graph space.

Desktop navigation and data selection is the same as for other layouts. You can:

* Navigate the mapped nodes using any GraphXR navigation method (for example, pan, zoom, rotate, *_Center To_* a single node or selection of nodes, and *_Fly Out_* to view all the mapped data)
* Select nodes using any selection method, and perform any of the data transformations, editing, or tagging available in the graph space.
* Save data views or snapshots for use in data visualization.

For example, we can tag groups of nodes according to regions on the map. Select the nodes, and click *_Tag_* to open the *_Manager Tags_* dialog. 

image::/v2_17/09_01_03a_TaggedMapTagMGR.png[,540,320,role=text-left]

YOu can also click *_Save Tags as Property_* to save the tags as a *_ _graphxrtags_* property, then used the *_Property_* list set persistent colors for each value. 

NOTE: If tags aren't saved as a property, they appear as white bubbles in the legend's *_Tags_* list. You can click the list bubble to select these tagged nodes, but since they don't appear in the *_Property_* list, you cannot assign a color or icon. 

In the map below, tags have been created to assign regions to sets of nodes. 

image::/v2_17/09_01_03b_TaggedMapTagProps.png[,720,380,role=text-left]

You can use a tag to select nodes by region then click the *_Center To_* icon to zoom in to the center point of the selection on the map.

== Using the Map Panel

Click the *_Map_* menu item to display the *_Map_* panel, which includes:

* *_Show Map_* to re-set the map (for example, after you have zoomed in to selected data, or flown away to a search location).
* *_Hide Map_* to dismiss the map and return the mapped data to the default force layout.
* *_Search Location_* bar to enter a place name and fly to that location.
* *_Map Control_* to reposition the map and adjust its boundaries.
* *_Setting_* to select a map server, install custom map servers, and set *_Mode_* and *_Auto Fitting_* options.
+
image::/v2_17/09_01_04a_MapPanel720.png[,520,280,role=text-left]

=== Using Show Map and Hide Map

Opening the *_Map_* panel automatically displays a map with boundaries set according to the coordinates in your data, and drops your graph data onto it.

* Click *_Hide Map_* to hide the map and return the data to the default force layout.
* Click *_Show Map_* to:
 ** Show the initial map again after using *_Hide Map_*.
 ** Reset the map to its initial position after using *_Search Location_* or *_Map Control_*.

You can click the *_Map_* panel icon to dismiss the panel. This only removes the panel, not the map. When you are done working with a map, click *_Map_* to open the panel, then click *_Hide Map_*.

=== Flying to a Search Location

You can fly to any named world location or region by entering its name in the *_Search Location_* bar. There does not need to be any mapped data for that location.

*To fly to a named location:*

. Open the *_Map_* panel.
. In the *_Search Location_* bar, enter the name of a location (e.g. _United Kingdom_) and click it on the search list.
+
The map centers on the named location.
+
image::/v2_17/09_01_04b_SearchMap.png[,720,380,role=text-left]

. To reset the map, clear the search by clicking the *_X_* icon in the search bar, then click *_Show Map_*.

=== Using Map Control

A map boundary is initially set based on the locations in the graph data, but a wider view is often desirable, for example, to display additional areas for which there is no data. *_Map Control_* mode lets you adjust the map boundary temporarily.

When you click *_Map Control_*, 3D navigation is de-activated.

*To adjust map boundaries:*

. Open the *_Map_* panel and click *_Map Control_*.
+
The button turns blue, indicating you are in map control mode.
+
image::/v2_17/09_01_06_MapControl1080.png[,520,280,role=text-left]

. Set the map boundaries with the following mouse controls or their equivalent keyboard shortcuts:
* Pan (*_left mouse click_drag_*) +
* Zoom (*_mouse scroll_* or *_2_*+*_left mouse click_* *drag*)
* Click *_Map Control_* to exit and resume 3D navigation with the adjusted map.
+

NOTE: Whenever you click *_Show Map_*, map boundaries are reset to the initial area bounded by the locations in the data. To retain adjusted boundaries you set in *Map Control*, de-select the *_AutoFitting_* checkbox in the *_Setting_* dialog.

=== Using Map Setting options

Map *_Setting_* options let you:

* Select an installed map server (e.g. MapBox, Google or OpenStreetMap)
* Add or delete custom map servers.
* Set *_Wall_* or *_Floor_* mode.
* Select or de-select the *_Auto Fitting_* option.
+
image::/v2_17/09_01_05_MapSetting720.png[,420,340,role=text-left]
